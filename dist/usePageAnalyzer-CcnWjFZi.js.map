{"version":3,"file":"usePageAnalyzer-CcnWjFZi.js","sources":["../node_modules/lucide-react/dist/esm/icons/chart-column.js","../src/features/page-analyzer/hooks/usePageAnalyzer.ts"],"sourcesContent":["/**\n * @license lucide-react v0.516.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 3v16a2 2 0 0 0 2 2h16\", key: \"c24i48\" }],\n  [\"path\", { d: \"M18 17V9\", key: \"2bz60n\" }],\n  [\"path\", { d: \"M13 17V5\", key: \"1frdt8\" }],\n  [\"path\", { d: \"M8 17v-3\", key: \"17ska0\" }]\n];\nconst ChartColumn = createLucideIcon(\"chart-column\", __iconNode);\n\nexport { __iconNode, ChartColumn as default };\n//# sourceMappingURL=chart-column.js.map\n","/**\n * Page Analyzer Hook - Simplified Demo\n * Shows Storage, Messaging, and API utilities with minimal complexity\n * @module @voilajsx/comet\n * @file src/features/page-analyzer/hooks/usePageAnalyzer.ts\n */\n\nimport { useState, useEffect } from 'react';\nimport { storage } from '@voilajsx/comet/storage';\nimport { messaging } from '@voilajsx/comet/messaging';\nimport { comet } from '@voilajsx/comet/api';\n\n// Simple types\ninterface PageData {\n  size: string;\n  url: string;\n  domain: string;\n  timestamp: number;\n}\n\ninterface ValidationResult {\n  isValid: boolean;\n  errors: number;\n  url: string;\n  domain: string;\n  timestamp: number;\n}\n\nexport function usePageAnalyzer() {\n  const [pageData, setPageData] = useState(null);\n  const [validationResult, setValidationResult] = useState(null);\n  const [settings, setSettings] = useState({ autoValidate: false, saveHistory: false });\n  const [history, setHistory] = useState([]);\n  const [loading, setLoading] = useState({ analyze: false, validate: false });\n\n  // Load data on mount\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      const autoValidate = await storage.get('pageAnalyzer.autoValidate', false);\n      const saveHistory = await storage.get('pageAnalyzer.saveHistory', false);\n      const savedHistory = await storage.get('pageAnalyzer.history', []);\n      \n      setSettings({ autoValidate, saveHistory });\n      setHistory(savedHistory);\n    } catch (error) {\n      console.error('Failed to load data:', error);\n    }\n  };\n\n  // Analyze page size (Messaging API demo)\n  const analyzePageSize = async () => {\n    setLoading(prev => ({ ...prev, analyze: true }));\n    \n    try {\n      const response = await messaging.sendToContent({\n        type: 'getPageSize',\n        data: {}\n      });\n      console.log('pagesize',response.data);\n      if (response.success) {\n        const data = {\n          size: response.data.formatted,\n          url: response.data.url,\n          domain: new URL(response.data.url).hostname,\n          timestamp: Date.now()\n        };\n        \n        setPageData(data);\n        \n        if (settings.saveHistory) {\n          await saveToHistory('analysis', data);\n        }\n\n        return { success: true, data };\n      } else {\n        throw new Error(response.error || 'Analysis failed');\n      }\n    } catch (error) {\n      return { success: false, error: error.message };\n    } finally {\n      setLoading(prev => ({ ...prev, analyze: false }));\n    }\n  };\n\n  // Validate HTML (API Utility demo)\n  const validateHTML = async () => {\n    setLoading(prev => ({ ...prev, validate: true }));\n    \n    try {\n      const currentTab = await messaging.getActiveTab();\n      if (!currentTab?.url) throw new Error('Cannot get current tab');\n      \n      const targetUrl = currentTab.url;\n      const domain = new URL(targetUrl).hostname;\n      \n      const response = await comet.get(\n        `https://validator.w3.org/nu/?doc=${encodeURIComponent(targetUrl)}&out=json`\n      );\n\n      if (response.ok) {\n        const messages = response.data.messages || [];\n        const errors = messages.filter(m => m.type === 'error').length;\n        \n        const result = {\n          isValid: errors === 0,\n          errors,\n          url: targetUrl,\n          domain,\n          timestamp: Date.now()\n        };\n        \n        setValidationResult(result);\n        \n        if (settings.saveHistory) {\n          await saveToHistory('validation', result);\n        }\n\n        return { success: true, data: result };\n      } else {\n        throw new Error('Validation service unavailable');\n      }\n    } catch (error) {\n      return { success: false, error: error.message };\n    } finally {\n      setLoading(prev => ({ ...prev, validate: false }));\n    }\n  };\n\n  // Save to history\n  const saveToHistory = async (type, data) => {\n    try {\n      const newEntry = { type, data, timestamp: Date.now() };\n      const updatedHistory = [newEntry, ...history.slice(0, 4)];\n      \n      setHistory(updatedHistory);\n      await storage.set('pageAnalyzer.history', updatedHistory);\n    } catch (error) {\n      console.error('Failed to save history:', error);\n    }\n  };\n\n  // Update setting\n  const updateSetting = async (key, value) => {\n    setSettings(prev => ({ ...prev, [key]: value }));\n    await storage.set(`pageAnalyzer.${key}`, value);\n  };\n\n  // Clear history\n  const clearHistory = async () => {\n    setHistory([]);\n    await storage.remove('pageAnalyzer.history');\n  };\n\n  return {\n    pageData,\n    validationResult,\n    settings,\n    history,\n    analyzePageSize,\n    validateHTML,\n    updateSetting,\n    clearHistory,\n    loading,\n    hasHistory: history.length > 0,\n  };\n}"],"names":["__iconNode","ChartColumn","createLucideIcon","usePageAnalyzer","pageData","setPageData","useState","validationResult","setValidationResult","settings","setSettings","history","setHistory","loading","setLoading","useEffect","loadData","autoValidate","storage","saveHistory","savedHistory","error","analyzePageSize","prev","response","messaging","data","saveToHistory","validateHTML","currentTab","targetUrl","domain","comet","errors","m","result","type","updatedHistory","key","value"],"mappings":"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","x_google_ignoreList":[0]}