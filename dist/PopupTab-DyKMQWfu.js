import{f as D,r as d,m as n,R as E,j as e,I as h,B as x}from"./index-CriA-yGf.js";import{c as B,L as M}from"./tabs-DeYq6__c.js";import{C as T,a as F,c as z,b as A}from"./card-Dc79FipO.js";import{A as I,a as R}from"./alert-x4edTDyv.js";import{s as L}from"./storage-Bz8_X7E-.js";import{C as U,a as f}from"./circle-check-big-D4JixKUs.js";/**
 * @license lucide-react v0.516.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],P=D("download",H);function q({value:g,currentTab:r}){const[u,p]=d.useState(!1),[c,a]=d.useState(null),[o,b]=d.useState(null),[t,S]=d.useState(!0);n.isTabSupported(r),E.useEffect(()=>{j()},[]);const j=async()=>{try{const s=await L.get("websiteScreenshot.enabled",!0);S(s)}catch(s){console.error("[Screenshot] Failed to load enabled state:",s)}},w=async()=>{if(!n.isTabSupported(r)){a({type:"error",message:"Screenshots not available on this page"});return}if(!t){a({type:"error",message:"Screenshot feature is disabled"});return}p(!0),a(null);try{const s=await new Promise((C,v)=>{chrome.tabs.captureVisibleTab(null,{format:"png"},k=>{chrome.runtime.lastError?v(new Error(chrome.runtime.lastError.message)):C(k)})}),l=s.split(",")[1],m=Math.round(l.length*3/4),i={dataUrl:s,filename:`screenshot-${Date.now()}.png`,size:m,timestamp:Date.now()};b(i),a({type:"success",message:"Screenshot captured!"})}catch(s){console.error("[Screenshot] Capture failed:",s),a({type:"error",message:s.message||"Could not take screenshot"})}finally{p(!1)}},y=()=>{if(o?.dataUrl)try{const s=document.createElement("a");s.href=o.dataUrl,s.download=o.filename||"screenshot.png",document.body.appendChild(s),s.click(),document.body.removeChild(s),a({type:"success",message:"Download started!"})}catch{a({type:"error",message:"Download failed"})}},N=s=>{if(s===0)return"0 Bytes";const l=1024,m=["Bytes","KB","MB"],i=Math.floor(Math.log(s)/Math.log(l));return parseFloat((s/Math.pow(l,i)).toFixed(1))+" "+m[i]};return e.jsx(B,{value:g,className:"mt-0",children:e.jsxs(T,{className:"bg-card border-border",children:[e.jsx(F,{className:"pb-3",children:e.jsxs(z,{className:"text-base flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),"Screenshot"]})}),e.jsxs(A,{className:"space-y-4",children:[e.jsx(x,{onClick:w,disabled:u||!n.isTabSupported(r)||!t,className:"w-full",children:u?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4 mr-2 animate-spin"}),"Taking Screenshot..."]}):e.jsxs(e.Fragment,{children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),t?n.isTabSupported(r)?"Take Screenshot":"Not Available":"Feature Disabled"]})}),c&&e.jsxs(I,{variant:c.type==="error"?"destructive":"default",children:[c.type==="success"?e.jsx(U,{className:"h-4 w-4 text-green-500"}):e.jsx(f,{className:"h-4 w-4"}),e.jsx(R,{children:c.message})]}),o&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-muted/50 p-3 rounded text-center",children:[e.jsx(h,{className:"w-6 h-6 mx-auto mb-2 text-muted-foreground"}),e.jsx("div",{className:"text-sm font-medium",children:"Screenshot Ready"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[N(o.size)," â€¢ PNG"]})]}),e.jsxs(x,{onClick:y,variant:"outline",className:"w-full",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Download Screenshot"]})]}),(!n.isTabSupported(r)||!t)&&e.jsxs("div",{className:"text-center text-sm text-muted-foreground py-2",children:[e.jsx(f,{className:"w-4 h-4 mx-auto mb-1"}),t?"Screenshots not available on extension pages":"Screenshot feature disabled in settings"]})]})]})})}export{q as default};
//# sourceMappingURL=PopupTab-DyKMQWfu.js.map
