{"version":3,"file":"bridge.js","sources":["../src/scripts/modules/pageAnalyzer.js","../src/platform/api.js","../src/scripts/modules/quoteGenerator.js","../src/platform/storage.js","../src/scripts/modules/userAuth.js","../src/platform/messaging.js","../src/scripts/bridge.js","../src/scripts/modules/tester.js"],"sourcesContent":["/**\n * Comet Framework - Page Analyzer Module\n * Simple page size and word count analysis\n * @module @voilajsx/comet\n * @file src/scripts/modules/pageAnalyzer.js\n */\n\n/**\n * Get basic page data\n * @returns {object} Simple page metrics\n */\nfunction getPageData() {\n  const text = document.body.innerText || '';\n  const words = text\n    .trim()\n    .split(/\\s+/)\n    .filter((word) => word.length > 0);\n\n  return {\n    wordCount: words.length,\n    pageSize: getPageSize(),\n    title: document.title,\n    url: window.location.href,\n  };\n}\n\n/**\n * Get page size information\n * @returns {object} Page size data\n */\nfunction getPageSize() {\n  const html = document.documentElement.outerHTML;\n  const text = document.body.innerText || '';\n\n  return {\n    htmlBytes: new Blob([html]).size,\n    textBytes: new Blob([text]).size,\n    formatted: formatBytes(new Blob([html]).size),\n  };\n}\n\n/**\n * Format bytes to readable string\n */\nfunction formatBytes(bytes) {\n  if (bytes === 0) return '0 Bytes';\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n}\n\n/**\n * Page Analyzer Module Configuration\n */\nconst pageAnalyzerModule = {\n  name: 'pageAnalyzer',\n\n  // Message handlers this module provides\n  handlers: {\n    getPageData: () => getPageData(),\n    getPageSize: () => getPageSize(),\n  },\n\n  // Main action for combined operations\n  mainAction: () => getPageData(),\n\n  // Module initialization (optional)\n  init: () => {\n    console.log('[Page Analyzer] Module initialized');\n  },\n};\n\n// âœ… Export module (instead of registerModule call)\nexport default pageAnalyzerModule;\n","/**\n * Comet Framework - Universal API utilities\n * Clean API proxy that works from any extension context\n * @module @voilajsx/comet\n * @file src/platform/api.js\n */\n\n/**\n * Universal API utilities that work from any extension context\n * Routes through background script to avoid CORS issues\n */\nexport const comet = {\n  // Base fetch method\n  async fetch(url, options = {}) {\n    try {\n      const response = await new Promise((resolve, reject) => {\n        chrome.runtime.sendMessage(\n          {\n            type: 'api.fetch',\n            data: {\n              url,\n              method: options.method || 'GET',\n              headers: options.headers || {}, // Make sure this is passed\n              body: options.body || null,\n              timeout: options.timeout || 30000,\n            },\n          },\n          (response) => {\n            if (chrome.runtime.lastError) {\n              reject(new Error(chrome.runtime.lastError.message));\n            } else {\n              resolve(response);\n            }\n          }\n        );\n      });\n\n      return {\n        ok: response.success,\n        status: response.status,\n        json: () => Promise.resolve(response.data),\n        data: response.data,\n        error: response.error,\n      };\n    } catch (error) {\n      return {\n        ok: false,\n        status: 0,\n        error: error.message,\n        json: () => Promise.reject(error),\n      };\n    }\n  },\n\n  // REST convenience methods\n  async get(url, headers = {}) {\n    return this.fetch(url, { method: 'GET', headers });\n  },\n\n  async post(url, data = null, headers = {}) {\n    return this.fetch(url, {\n      method: 'POST',\n      body: data,\n      headers, // Headers should be passed here\n    });\n  },\n\n  async put(url, data = null, headers = {}) {\n    return this.fetch(url, {\n      method: 'PUT',\n      body: data,\n      headers,\n    });\n  },\n\n  async patch(url, data = null, headers = {}) {\n    return this.fetch(url, {\n      method: 'PATCH',\n      body: data,\n      headers,\n    });\n  },\n\n  async delete(url, headers = {}) {\n    return this.fetch(url, { method: 'DELETE', headers });\n  },\n};\n","/**\n * Comet Framework - Quote Generator Module (Simplified)\n * Fetches inspirational quotes using Comet API utilities\n * @module @voilajsx/comet\n * @file src/scripts/modules/quoteGenerator.js\n */\n\nimport { comet } from '@voilajsx/comet/api';\n\n/**\n * Quote Generator Module Configuration\n */\nconst quoteGeneratorModule = {\n  name: 'quoteGenerator',\n\n  handlers: {\n    getQuote: () => getRandomQuote(),\n    getMotivationalQuote: () => getMotivationalQuote(),\n  },\n\n  mainAction: () => getRandomQuote(),\n\n  init: () => {\n    console.log('[Quote Generator] Module initialized');\n  },\n};\n\n/**\n * Get a random quote with backup API\n */\nasync function getRandomQuote() {\n  const apis = [\n    {\n      url: 'https://api.adviceslip.com/advice',\n      transform: (response) => ({\n        text: response.data.data.slip.advice, // response.data.data.slip.advice\n        author: 'Anonymous',\n        tags: ['advice'],\n      }),\n    },\n    {\n      url: 'https://api.kanye.rest/',\n      transform: (response) => ({\n        text: response.data.data.quote, // response.data.data.quote\n        author: 'Kanye West',\n        tags: ['inspiration'],\n      }),\n    },\n  ];\n\n  for (const api of apis) {\n    try {\n      console.log(`[Quote Generator] Trying ${api.url}`);\n      const response = await comet.get(api.url);\n\n      console.log(\n        `[Quote Generator] Full response:`,\n        JSON.stringify(response, null, 2)\n      );\n\n      if (response.ok && response.data && response.data.data) {\n        const quote = api.transform(response);\n\n        console.log(`[Quote Generator] Transformed quote:`, quote);\n\n        return {\n          success: true,\n          quote: {\n            text: quote.text,\n            author: quote.author,\n            length: quote.text.length,\n            tags: quote.tags,\n          },\n          timestamp: Date.now(),\n        };\n      }\n    } catch (error) {\n      console.warn(`[Quote Generator] API failed:`, error);\n      continue;\n    }\n  }\n\n  return {\n    success: false,\n    error: 'APIs unavailable',\n    fallbackQuote: getFallbackQuote(),\n  };\n}\n\n/**\n * Get motivational quote\n */\nasync function getMotivationalQuote() {\n  const result = await getRandomQuote();\n\n  if (result.success) {\n    result.quote.category = 'motivational';\n    return result;\n  }\n\n  return {\n    success: false,\n    error: result.error,\n    fallbackQuote: getMotivationalFallback(),\n  };\n}\n\n/**\n * Fallback quotes\n */\nfunction getFallbackQuote() {\n  const quotes = [\n    {\n      text: 'The only way to do great work is to love what you do.',\n      author: 'Steve Jobs',\n    },\n    {\n      text: \"Life is what happens while you're busy making other plans.\",\n      author: 'John Lennon',\n    },\n    {\n      text: 'The future belongs to those who believe in their dreams.',\n      author: 'Eleanor Roosevelt',\n    },\n  ];\n\n  const quote = quotes[Math.floor(Math.random() * quotes.length)];\n  return { ...quote, source: 'fallback', tags: ['wisdom'] };\n}\n\nfunction getMotivationalFallback() {\n  const quotes = [\n    {\n      text: 'Success is courage to continue despite failures.',\n      author: 'Winston Churchill',\n    },\n    {\n      text: 'The only impossible journey is the one you never begin.',\n      author: 'Tony Robbins',\n    },\n    {\n      text: \"Don't watch the clock; keep going like it does.\",\n      author: 'Sam Levenson',\n    },\n  ];\n\n  const quote = quotes[Math.floor(Math.random() * quotes.length)];\n  return {\n    ...quote,\n    category: 'motivational',\n    source: 'fallback',\n    tags: ['motivation'],\n  };\n}\n\nexport default quoteGeneratorModule;\n","/**\n * Comet Extension Storage Utility (Cross-Browser)\n * Enhanced storage with auto-loading defaults from defaults.json\n * Works with Chrome, Firefox, Edge, Opera, Brave, and other WebExtension browsers\n * @module @voilajsx/comet\n * @file src/platform/storage.js\n */\n\n// Cross-browser API detection\nconst browserAPI = (() => {\n  if (typeof browser !== 'undefined') {\n    return browser; // Firefox, newer browsers\n  } else if (typeof chrome !== 'undefined') {\n    return chrome; // Chrome, Edge, Opera, Brave\n  } else {\n    throw new Error('No browser extension API available');\n  }\n})();\n\n/**\n * Enhanced Comet Storage Manager\n * Auto-loads defaults and provides unified API for all data access\n */\nclass CometStorageManager {\n  constructor() {\n    this.api = browserAPI;\n    this.syncQuota = this.api.storage.sync.QUOTA_BYTES || 102400; // 100KB\n    this.localQuota = this.api.storage.local.QUOTA_BYTES || 10485760; // 10MB\n    this.syncItemQuota = this.api.storage.sync.QUOTA_BYTES_PER_ITEM || 8192; // 8KB per item\n\n    // Defaults management\n    this.defaults = {};\n    this.defaultsLoaded = false;\n    this.isInitialized = false;\n\n    this.initialize();\n  }\n\n  /**\n   * Initialize storage with auto-loading defaults\n   */\n  async initialize() {\n    if (this.isInitialized) return;\n\n    try {\n      await this.loadDefaults();\n      await this.initializeDefaults();\n      this.isInitialized = true;\n      console.log('[Comet Storage] Initialized with defaults');\n    } catch (error) {\n      console.warn(\n        '[Comet Storage] Initialization failed, continuing without defaults:',\n        error\n      );\n      this.defaults = {};\n      this.defaultsLoaded = true;\n      this.isInitialized = true;\n    }\n  }\n\n  /**\n   * Load defaults from defaults.json\n   */\n  async loadDefaults() {\n    if (this.defaultsLoaded) return;\n\n    try {\n      // Try to import defaults.json\n      const defaultsModule = await import('../defaults.json');\n      this.defaults = defaultsModule.default || {};\n      this.defaultsLoaded = true;\n      console.log('[Comet Storage] Loaded defaults from defaults.json');\n    } catch (error) {\n      console.log(\n        '[Comet Storage] No defaults.json found, using empty defaults'\n      );\n      this.defaults = {};\n      this.defaultsLoaded = true;\n    }\n  }\n\n  /**\n   * Initialize storage with defaults on first run\n   */\n  async initializeDefaults() {\n    try {\n      // Check if we've already initialized defaults\n      const isInitialized = await this.api.storage.local.get(\n        '_defaultsInitialized'\n      );\n\n      if (isInitialized._defaultsInitialized) {\n        return; // Already initialized\n      }\n\n      // Load defaults into storage\n      if (Object.keys(this.defaults).length > 0) {\n        await this.setDefaults(this.defaults);\n        console.log('[Comet Storage] Initialized storage with defaults');\n      }\n\n      // Mark as initialized\n      await this.api.storage.local.set({ _defaultsInitialized: true });\n    } catch (error) {\n      console.warn('[Comet Storage] Failed to initialize defaults:', error);\n    }\n  }\n\n  /**\n   * Recursively set default values\n   */\n  async setDefaults(obj, prefix = '') {\n    for (const [key, value] of Object.entries(obj)) {\n      const fullKey = prefix ? `${prefix}.${key}` : key;\n\n      if (value && typeof value === 'object' && !Array.isArray(value)) {\n        // Recursive for nested objects\n        await this.setDefaults(value, fullKey);\n      } else {\n        // Check if key already exists\n        const existingValue = await this.getRaw(fullKey);\n        if (existingValue === undefined) {\n          // Only set if not already exists\n          await this.setRaw(fullKey, value);\n        }\n      }\n    }\n  }\n\n  /**\n   * Get data from browser storage with auto-fallback to defaults\n   * @param {string|array|object|null} keys - Keys to retrieve\n   * @param {any} fallback - Fallback value if not found\n   * @param {string} [namespace='auto'] - Storage namespace (sync/local/auto)\n   * @returns {Promise<any>} Retrieved data\n   */\n  async get(keys = null, fallback = undefined, namespace = 'auto') {\n    try {\n      await this.initialize();\n\n      // Handle single key string\n      if (typeof keys === 'string') {\n        const value = await this.getRaw(keys, namespace);\n\n        if (value !== undefined) {\n          return value;\n        }\n\n        // Try to get from defaults\n        const defaultValue = this.getDefaultByPath(keys);\n        if (defaultValue !== undefined) {\n          return defaultValue;\n        }\n\n        return fallback;\n      }\n\n      // Handle array of keys\n      if (Array.isArray(keys)) {\n        const result = {};\n        for (const key of keys) {\n          result[key] = await this.get(key, undefined, namespace);\n        }\n        return result;\n      }\n\n      // Handle null (get all)\n      if (keys === null) {\n        const storageArea = this.getStorageArea(namespace, 'read');\n        const result = await storageArea.get(null);\n\n        // Merge with defaults\n        return this.mergeWithDefaults(result);\n      }\n\n      // Handle object (get multiple specific keys)\n      const result = {};\n      for (const key of Object.keys(keys)) {\n        result[key] = await this.get(key, keys[key], namespace);\n      }\n      return result;\n    } catch (error) {\n      console.error('[Comet Storage] Get operation failed:', error);\n      throw new CometStorageError('Failed to read from storage', error);\n    }\n  }\n\n  /**\n   * Set data to browser storage\n   * @param {object|string} data - Data to store (object) or key (string)\n   * @param {any} [value] - Value if first param is key string\n   * @param {string} [namespace='auto'] - Storage namespace (sync/local/auto)\n   * @returns {Promise<boolean>} Success status\n   */\n  async set(data, value = undefined, namespace = 'auto') {\n    try {\n      await this.initialize();\n\n      // Handle set(key, value) syntax\n      if (typeof data === 'string') {\n        return await this.setRaw(data, value, namespace);\n      }\n\n      // Handle object syntax\n      const results = [];\n      for (const [key, val] of Object.entries(data)) {\n        results.push(await this.setRaw(key, val, namespace));\n      }\n\n      return results.every((result) => result === true);\n    } catch (error) {\n      console.error('[Comet Storage] Set operation failed:', error);\n      throw new CometStorageError('Failed to write to storage', error);\n    }\n  }\n\n  /**\n   * Remove data from browser storage\n   * @param {string|array} keys - Keys to remove\n   * @param {string} [namespace='auto'] - Storage namespace (sync/local/auto)\n   * @returns {Promise<boolean>} Success status\n   */\n  async remove(keys, namespace = 'auto') {\n    try {\n      const storageArea = this.getStorageArea(namespace, 'write');\n\n      if (typeof keys === 'string') {\n        await storageArea.remove(keys);\n      } else {\n        await storageArea.remove(keys);\n      }\n\n      return true;\n    } catch (error) {\n      console.error('[Comet Storage] Remove operation failed:', error);\n      throw new CometStorageError('Failed to remove from storage', error);\n    }\n  }\n\n  /**\n   * Clear all data from browser storage\n   * @param {string} [namespace='both'] - Storage namespace (sync/local/both)\n   * @returns {Promise<boolean>} Success status\n   */\n  async clear(namespace = 'both') {\n    try {\n      if (namespace === 'both') {\n        await Promise.all([\n          this.api.storage.sync.clear(),\n          this.api.storage.local.clear(),\n        ]);\n      } else {\n        const storageArea = this.getStorageArea(namespace, 'write');\n        await storageArea.clear();\n      }\n      return true;\n    } catch (error) {\n      console.error('[Comet Storage] Clear operation failed:', error);\n      throw new CometStorageError('Failed to clear storage', error);\n    }\n  }\n\n  /**\n   * Check if data exists in storage (including defaults)\n   * @param {string} key - Key to check\n   * @param {string} [namespace='auto'] - Storage namespace\n   * @returns {Promise<boolean>} True if key exists\n   */\n  async has(key, namespace = 'auto') {\n    try {\n      const value = await this.get(key, undefined, namespace);\n      return value !== undefined;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Get storage usage information\n   * @param {string} [namespace='both'] - Storage namespace (sync/local/both)\n   * @returns {Promise<object>} Usage information\n   */\n  async getUsage(namespace = 'both') {\n    try {\n      const usage = {};\n\n      if (namespace === 'both' || namespace === 'sync') {\n        const syncUsed = await this.api.storage.sync.getBytesInUse();\n        usage.sync = {\n          used: syncUsed,\n          total: this.syncQuota,\n          percentage: Math.round((syncUsed / this.syncQuota) * 100),\n          available: this.syncQuota - syncUsed,\n        };\n      }\n\n      if (namespace === 'both' || namespace === 'local') {\n        const localUsed = await this.api.storage.local.getBytesInUse();\n        usage.local = {\n          used: localUsed,\n          total: this.localQuota,\n          percentage: Math.round((localUsed / this.localQuota) * 100),\n          available: this.localQuota - localUsed,\n        };\n      }\n\n      return usage;\n    } catch (error) {\n      console.error('[Comet Storage] Usage check failed:', error);\n      return { sync: { used: 0, total: 0, percentage: 0, available: 0 } };\n    }\n  }\n\n  /**\n   * Listen to storage changes\n   * @param {function} callback - Callback function (changes, namespace) => void\n   * @returns {function} Unsubscribe function\n   */\n  onChange(callback) {\n    const listener = (changes, namespace) => {\n      callback(changes, namespace);\n    };\n\n    this.api.storage.onChanged.addListener(listener);\n\n    // Return unsubscribe function\n    return () => {\n      this.api.storage.onChanged.removeListener(listener);\n    };\n  }\n\n  /**\n   * Reset storage to defaults\n   * @returns {Promise<boolean>} Success status\n   */\n  async resetToDefaults() {\n    try {\n      await this.clear();\n      await this.api.storage.local.remove('_defaultsInitialized');\n      await this.initializeDefaults();\n      console.log('[Comet Storage] Reset to defaults');\n      return true;\n    } catch (error) {\n      console.error('[Comet Storage] Reset failed:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Get all defaults\n   * @returns {object} Defaults object\n   */\n  getDefaults() {\n    return JSON.parse(JSON.stringify(this.defaults));\n  }\n\n  // ===== INTERNAL HELPER METHODS =====\n\n  /**\n   * Raw get without defaults fallback\n   */\n  async getRaw(key, namespace = 'auto') {\n    const storageArea = this.getStorageArea(namespace, 'read');\n    const result = await storageArea.get(key);\n    return result[key];\n  }\n\n  /**\n   * Raw set without validation\n   */\n  async setRaw(key, value, namespace = 'auto') {\n    const items = { [key]: value };\n    const storageArea = this.getStorageArea(namespace, 'write', items);\n\n    // Validate data size\n    this.validateDataSize(items, storageArea);\n\n    await storageArea.set(items);\n    return true;\n  }\n\n  /**\n   * Get default value by path\n   */\n  getDefaultByPath(path) {\n    return path.split('.').reduce((obj, key) => obj?.[key], this.defaults);\n  }\n\n  /**\n   * Merge storage result with defaults\n   */\n  mergeWithDefaults(storageData) {\n    const result = JSON.parse(JSON.stringify(this.defaults));\n\n    // Overlay storage data on defaults\n    for (const [key, value] of Object.entries(storageData)) {\n      if (key !== '_defaultsInitialized') {\n        this.setByPath(result, key, value);\n      }\n    }\n\n    return result;\n  }\n\n  /**\n   * Set value by path in object\n   */\n  setByPath(obj, path, value) {\n    const keys = path.split('.');\n    const lastKey = keys.pop();\n    const target = keys.reduce((o, key) => {\n      if (!(key in o)) o[key] = {};\n      return o[key];\n    }, obj);\n    target[lastKey] = value;\n  }\n\n  /**\n   * Determine appropriate storage area\n   */\n  getStorageArea(namespace, operation, data = null) {\n    if (namespace === 'sync') return this.api.storage.sync;\n    if (namespace === 'local') return this.api.storage.local;\n\n    // Auto mode: decide based on data size and operation\n    if (namespace === 'auto') {\n      if (operation === 'read') {\n        return this.api.storage.sync;\n      }\n\n      if (data) {\n        const dataSize = this.calculateDataSize(data);\n        return dataSize > this.syncItemQuota\n          ? this.api.storage.local\n          : this.api.storage.sync;\n      }\n    }\n\n    return this.api.storage.sync;\n  }\n\n  /**\n   * Calculate data size in bytes\n   */\n  calculateDataSize(data) {\n    try {\n      return new Blob([JSON.stringify(data)]).size;\n    } catch (error) {\n      return JSON.stringify(data).length;\n    }\n  }\n\n  /**\n   * Validate data size against storage limits\n   */\n  validateDataSize(data, storageArea) {\n    const dataSize = this.calculateDataSize(data);\n    const isSync = storageArea === this.api.storage.sync;\n\n    if (isSync) {\n      for (const [key, value] of Object.entries(data)) {\n        const itemSize = this.calculateDataSize({ [key]: value });\n        if (itemSize > this.syncItemQuota) {\n          throw new CometStorageError(\n            `Item \"${key}\" exceeds sync storage item limit (${itemSize} > ${this.syncItemQuota} bytes)`\n          );\n        }\n      }\n\n      if (dataSize > this.syncQuota) {\n        throw new CometStorageError(\n          `Data exceeds sync storage quota (${dataSize} > ${this.syncQuota} bytes)`\n        );\n      }\n    } else {\n      if (dataSize > this.localQuota) {\n        throw new CometStorageError(\n          `Data exceeds local storage quota (${dataSize} > ${this.localQuota} bytes)`\n        );\n      }\n    }\n  }\n}\n\n/**\n * Comet storage error class\n */\nclass CometStorageError extends Error {\n  constructor(message, originalError) {\n    super(message);\n    this.name = 'CometStorageError';\n    this.originalError = originalError;\n  }\n}\n\n// Create and export storage instance\nexport const storage = new CometStorageManager();\n\n// Export class for advanced usage\nexport { CometStorageManager, CometStorageError };\n","/**\n * Comet Framework - User Authentication Module (Cross-browser with 7-day sessions)\n * Demonstrates login/logout/auth flows with persistent sessions\n * @module @voilajsx/comet\n * @file src/scripts/modules/userAuth.js\n */\n\nimport { comet } from '@voilajsx/comet/api';\nimport { storage } from '@voilajsx/comet/storage';\n\n/**\n * User Auth Module Configuration\n */\nconst userAuthModule = {\n  name: 'userAuth',\n\n  handlers: {\n    login: (data) => loginUser(data),\n    logout: () => logoutUser(),\n    getProfile: () => getUserProfile(),\n    getAuthStatus: (data) => checkAuthStatus(data),\n  },\n\n  mainAction: (data) => checkAuthStatus(data),\n\n  init: () => {\n    console.log('[User Auth] Module initialized with 7-day sessions');\n  },\n};\n\n/**\n * Login user with email and password\n */\n/**\n * Login user with email and password\n */\nasync function loginUser(data) {\n  try {\n    const { email, password } = data || {};\n\n    if (!email || !password) {\n      return {\n        success: false,\n        error: 'Email and password required',\n      };\n    }\n\n    console.log('[User Auth] Attempting login with:', { email });\n\n    const response = await comet.post(\n      'https://reqres.in/api/login',\n      {\n        email: email,\n        password: password,\n      },\n      {\n        'x-api-key': 'reqres-free-v1',\n      }\n    );\n\n    console.log(\n      '[User Auth] Full response:',\n      JSON.stringify(response, null, 2)\n    );\n\n    // Fix: Check the nested data structure\n    // response.data.data.token (not response.data.token)\n    if (\n      response.ok &&\n      response.data &&\n      response.data.data &&\n      response.data.data.token\n    ) {\n      await storeAuthToken(response.data.data.token);\n      return {\n        success: true,\n        message: 'Login successful',\n        user: {\n          email: email,\n          token: response.data.data.token,\n          loginTime: Date.now(),\n        },\n      };\n    } else {\n      const errorMsg =\n        response.data?.data?.error ||\n        response.data?.error ||\n        response.error ||\n        `HTTP ${response.data?.status}`;\n      return {\n        success: false,\n        error: errorMsg,\n      };\n    }\n  } catch (error) {\n    console.error('[User Auth] Login failed:', error);\n    return {\n      success: false,\n      error: 'Login request failed',\n      details: error.message,\n    };\n  }\n}\n\n/**\n * Logout user - clear stored auth data\n */\nasync function logoutUser() {\n  try {\n    await storage.remove([\n      'auth.token',\n      'auth.timestamp',\n      'auth.userData',\n      'auth.userCacheTime',\n      'auth.userEmail',\n    ]);\n\n    console.log('[User Auth] User logged out successfully');\n    return {\n      success: true,\n      message: 'Logged out successfully',\n      timestamp: Date.now(),\n    };\n  } catch (error) {\n    console.error('[User Auth] Logout failed:', error);\n    return {\n      success: false,\n      error: 'Logout failed',\n      details: error.message,\n    };\n  }\n}\n\n/**\n * Get user profile using stored token\n */\nasync function getUserProfile() {\n  try {\n    const token = await getStoredAuthToken();\n\n    if (!token) {\n      return {\n        success: false,\n        error: 'No authentication token found',\n        needsLogin: true,\n      };\n    }\n\n    // Check cached user data first\n    const cachedUserData = await getCachedUserData();\n    if (cachedUserData) {\n      return {\n        success: true,\n        profile: cachedUserData,\n      };\n    }\n\n    const response = await comet.get('https://reqres.in/api/users/2', {\n      Authorization: `Bearer ${token}`,\n      'x-api-key': 'reqres-free-v1',\n    });\n\n    if (response.ok && response.data && response.data.data) {\n      const user = response.data.data;\n      const userData = {\n        id: user.id,\n        email: user.email,\n        firstName: user.first_name,\n        lastName: user.last_name,\n        name: `${user.first_name} ${user.last_name}`,\n        avatar: user.avatar,\n        lastAccess: Date.now(),\n      };\n\n      await cacheUserData(userData);\n      return {\n        success: true,\n        profile: userData,\n      };\n    } else {\n      return {\n        success: false,\n        error: 'Failed to fetch profile',\n        needsLogin: true,\n      };\n    }\n  } catch (error) {\n    console.error('[User Auth] Profile fetch failed:', error);\n    return {\n      success: false,\n      error: 'Profile request failed',\n      details: error.message,\n    };\n  }\n}\n\n/**\n * Check current authentication status with 7-day session\n */\nasync function checkAuthStatus(data = {}) {\n  try {\n    const sessionDays =\n      data.sessionDays || (await storage.get('auth.sessionDays', 7));\n    const token = await getStoredAuthToken(sessionDays);\n\n    if (token) {\n      return {\n        success: true,\n        authenticated: true,\n        hasToken: true,\n        message: 'User is authenticated',\n        sessionDays: sessionDays,\n        timestamp: Date.now(),\n      };\n    } else {\n      return {\n        success: true,\n        authenticated: false,\n        message: 'No valid token found',\n        sessionDays: sessionDays,\n        timestamp: Date.now(),\n      };\n    }\n  } catch (error) {\n    console.error('[User Auth] Auth status check failed:', error);\n    return {\n      success: false,\n      authenticated: false,\n      error: error.message,\n    };\n  }\n}\n\n/**\n * Store authentication token using Comet storage\n */\nasync function storeAuthToken(token) {\n  try {\n    await storage.set({\n      'auth.token': token,\n      'auth.timestamp': Date.now(),\n    });\n    console.log('[User Auth] Token stored successfully');\n  } catch (error) {\n    console.error('[User Auth] Failed to store token:', error);\n  }\n}\n\n/**\n * Get stored authentication token with 7-day expiry\n */\nasync function getStoredAuthToken(sessionDays = 7) {\n  try {\n    const token = await storage.get('auth.token');\n    const timestamp = await storage.get('auth.timestamp');\n\n    if (!token || !timestamp) {\n      return null;\n    }\n\n    const tokenAge = Date.now() - timestamp;\n    const maxAge = sessionDays * 24 * 60 * 60 * 1000;\n\n    if (tokenAge < maxAge) {\n      return token;\n    }\n\n    // Token expired\n    console.log(\n      `[User Auth] Token expired after ${sessionDays} days, removing`\n    );\n    await storage.remove([\n      'auth.token',\n      'auth.timestamp',\n      'auth.userData',\n      'auth.userCacheTime',\n      'auth.userEmail',\n    ]);\n\n    return null;\n  } catch (error) {\n    console.error('[User Auth] Failed to get token:', error);\n    return null;\n  }\n}\n\n/**\n * Cache user data for faster loads\n */\nasync function cacheUserData(userData) {\n  try {\n    await storage.set({\n      'auth.userData': userData,\n      'auth.userCacheTime': Date.now(),\n    });\n  } catch (error) {\n    console.error('[User Auth] Failed to cache user data:', error);\n  }\n}\n\n/**\n * Get cached user data if fresh (1 hour cache)\n */\nasync function getCachedUserData() {\n  try {\n    const userData = await storage.get('auth.userData');\n    const cacheTime = await storage.get('auth.userCacheTime');\n\n    if (!userData || !cacheTime) {\n      return null;\n    }\n\n    const cacheAge = Date.now() - cacheTime;\n    const maxCacheAge = 60 * 60 * 1000; // 1 hour\n\n    if (cacheAge < maxCacheAge) {\n      return userData;\n    }\n\n    return null;\n  } catch (error) {\n    console.error('[User Auth] Failed to get cached user data:', error);\n    return null;\n  }\n}\n\nexport default userAuthModule;\n","/**\n * Comet Extension Messaging Utility (Cross-Browser)\n * Provides clean interface for browser messaging between extension components\n * Works with Chrome, Firefox, Edge, Opera, Brave, and other WebExtension browsers\n * @module @voilajsx/comet\n * @file src/platform/messaging.js\n */\n\n// Cross-browser API detection\nconst browserAPI = (() => {\n  if (typeof browser !== 'undefined') {\n    return browser; // Firefox, newer browsers\n  } else if (typeof chrome !== 'undefined') {\n    return chrome; // Chrome, Edge, Opera, Brave\n  } else {\n    throw new Error('No browser extension API available');\n  }\n})();\n\n/**\n * Comet Messaging Manager\n * Handles all browser extension messaging with error handling and retry logic\n */\nclass CometMessagingManager {\n  constructor() {\n    this.api = browserAPI;\n    this.messageId = 0;\n    this.pendingMessages = new Map();\n    this.messageTimeout = 30000; // 30 seconds default timeout\n    this.retryAttempts = 3;\n    this.retryDelay = 1000; // 1 second\n  }\n\n  /**\n   * Send message to background script\n   * @param {object} message - Message object\n   * @param {object} [options={}] - Options (timeout, retries)\n   * @returns {Promise<object>} Response from background\n   */\n  async sendToBackground(message, options = {}) {\n    try {\n      const messageWithId = this.createMessage(message);\n      const timeout = options.timeout || this.messageTimeout;\n      const retries = options.retries || this.retryAttempts;\n\n      return await this.retryOperation(\n        () => this.sendRuntimeMessage(messageWithId, timeout),\n        retries,\n        'background script'\n      );\n    } catch (error) {\n      console.error('[Comet Messaging] Background message failed:', error);\n      throw new CometMessagingError(\n        'Failed to communicate with background script',\n        error\n      );\n    }\n  }\n\n  /**\n   * Send message to content script in active tab\n   * @param {object} message - Message object\n   * @param {number} [tabId] - Specific tab ID (defaults to active tab)\n   * @param {object} [options={}] - Options (timeout, retries)\n   * @returns {Promise<object>} Response from content script\n   */\n  async sendToContent(message, tabId = null, options = {}) {\n    try {\n      const targetTabId = tabId || (await this.getActiveTabId());\n      const messageWithId = this.createMessage(message);\n      const timeout = options.timeout || this.messageTimeout;\n      const retries = options.retries || this.retryAttempts;\n\n      if (!targetTabId) {\n        throw new Error('No active tab found');\n      }\n\n      return await this.retryOperation(\n        () => this.sendTabMessage(targetTabId, messageWithId, timeout),\n        retries,\n        `content script (tab ${targetTabId})`\n      );\n    } catch (error) {\n      console.error('[Comet Messaging] Content script message failed:', error);\n      throw new CometMessagingError(\n        'Failed to communicate with content script',\n        error\n      );\n    }\n  }\n\n  /**\n   * Send message to specific tab\n   * @param {number} tabId - Tab ID\n   * @param {object} message - Message object\n   * @param {object} [options={}] - Options (timeout, retries)\n   * @returns {Promise<object>} Response from tab\n   */\n  async sendToTab(tabId, message, options = {}) {\n    try {\n      const messageWithId = this.createMessage(message);\n      const timeout = options.timeout || this.messageTimeout;\n      const retries = options.retries || this.retryAttempts;\n\n      return await this.retryOperation(\n        () => this.sendTabMessage(tabId, messageWithId, timeout),\n        retries,\n        `tab ${tabId}`\n      );\n    } catch (error) {\n      console.error('[Comet Messaging] Tab message failed:', error);\n      throw new CometMessagingError(\n        `Failed to communicate with tab ${tabId}`,\n        error\n      );\n    }\n  }\n\n  /**\n   * Broadcast message to all tabs with content scripts\n   * @param {object} message - Message object\n   * @param {object} [options={}] - Options (timeout, retries)\n   * @returns {Promise<array>} Array of responses from all tabs\n   */\n  async broadcast(message, options = {}) {\n    try {\n      const tabs = await this.api.tabs.query({});\n      const messageWithId = this.createMessage(message);\n      const responses = [];\n\n      for (const tab of tabs) {\n        try {\n          const response = await this.sendToTab(tab.id, messageWithId, {\n            ...options,\n            retries: 1, // Lower retries for broadcast\n          });\n          responses.push({\n            tabId: tab.id,\n            url: tab.url,\n            success: true,\n            response,\n          });\n        } catch (error) {\n          responses.push({\n            tabId: tab.id,\n            url: tab.url,\n            success: false,\n            error: error.message,\n          });\n        }\n      }\n\n      return responses;\n    } catch (error) {\n      console.error('[Comet Messaging] Broadcast failed:', error);\n      throw new CometMessagingError('Failed to broadcast message', error);\n    }\n  }\n\n  /**\n   * Listen for messages from any source\n   * @param {function} callback - Message handler (message, sender) => response\n   * @returns {function} Unsubscribe function\n   */\n  onMessage(callback) {\n    const listener = (message, sender, sendResponse) => {\n      try {\n        const result = callback(message, sender);\n\n        // Handle async responses\n        if (result instanceof Promise) {\n          result\n            .then((response) => sendResponse(response))\n            .catch((error) =>\n              sendResponse({\n                success: false,\n                error: error.message,\n              })\n            );\n          return true; // Keep message channel open\n        }\n\n        // Handle sync responses\n        if (result !== undefined) {\n          sendResponse(result);\n        }\n      } catch (error) {\n        console.error('[Comet Messaging] Message handler error:', error);\n        sendResponse({\n          success: false,\n          error: error.message,\n        });\n      }\n    };\n\n    this.api.runtime.onMessage.addListener(listener);\n\n    // Return unsubscribe function\n    return () => {\n      this.api.runtime.onMessage.removeListener(listener);\n    };\n  }\n\n  /**\n   * Listen for messages of specific type\n   * @param {string} type - Message type to listen for\n   * @param {function} callback - Message handler (data, sender) => response\n   * @returns {function} Unsubscribe function\n   */\n  onMessageType(type, callback) {\n    return this.onMessage((message, sender) => {\n      if (message.type === type) {\n        return callback(message.data, sender);\n      }\n    });\n  }\n\n  /**\n   * Get current active tab\n   * @returns {Promise<object|null>} Active tab or null\n   */\n  async getActiveTab() {\n    try {\n      const [activeTab] = await this.api.tabs.query({\n        active: true,\n        currentWindow: true,\n      });\n      return activeTab || null;\n    } catch (error) {\n      console.error('[Comet Messaging] Failed to get active tab:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Get active tab ID\n   * @returns {Promise<number|null>} Active tab ID or null\n   */\n  async getActiveTabId() {\n    const tab = await this.getActiveTab();\n    return tab?.id || null;\n  }\n\n  /**\n   * Check if tab supports content scripts\n   * @param {object|string} tab - Tab object or URL string\n   * @returns {boolean} True if tab supports content scripts\n   */\n  isTabSupported(tab) {\n    const url = typeof tab === 'string' ? tab : tab?.url;\n    if (!url) return false;\n\n    const unsupportedPrefixes = [\n      'chrome://',\n      'chrome-extension://',\n      'moz-extension://',\n      'about:',\n      'file://',\n      'ftp://',\n      'data:',\n      'blob:',\n    ];\n\n    return !unsupportedPrefixes.some((prefix) => url.startsWith(prefix));\n  }\n\n  /**\n   * Create message with unique ID and timestamp\n   * @private\n   */\n  createMessage(message) {\n    return {\n      id: ++this.messageId,\n      timestamp: Date.now(),\n      ...message,\n    };\n  }\n\n  /**\n   * Send runtime message with timeout\n   * @private\n   */\n  async sendRuntimeMessage(message, timeout) {\n    return new Promise((resolve, reject) => {\n      const timeoutId = setTimeout(() => {\n        reject(new Error('Message timeout'));\n      }, timeout);\n\n      this.api.runtime.sendMessage(message, (response) => {\n        clearTimeout(timeoutId);\n\n        if (this.api.runtime.lastError) {\n          reject(new Error(this.api.runtime.lastError.message));\n          return;\n        }\n\n        resolve(response || { success: false, error: 'No response' });\n      });\n    });\n  }\n\n  /**\n   * Send tab message with timeout\n   * @private\n   */\n  async sendTabMessage(tabId, message, timeout) {\n    return new Promise((resolve, reject) => {\n      const timeoutId = setTimeout(() => {\n        reject(new Error('Message timeout'));\n      }, timeout);\n\n      this.api.tabs.sendMessage(tabId, message, (response) => {\n        clearTimeout(timeoutId);\n\n        if (this.api.runtime.lastError) {\n          reject(new Error(this.api.runtime.lastError.message));\n          return;\n        }\n\n        resolve(response || { success: false, error: 'No response' });\n      });\n    });\n  }\n\n  /**\n   * Retry operation with exponential backoff\n   * @private\n   */\n  async retryOperation(operation, maxRetries, target) {\n    let lastError;\n\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        return await operation();\n      } catch (error) {\n        lastError = error;\n\n        if (attempt === maxRetries) break;\n\n        const delay = this.retryDelay * Math.pow(2, attempt);\n        console.warn(\n          `[Comet Messaging] Retry ${\n            attempt + 1\n          }/${maxRetries} for ${target} after ${delay}ms:`,\n          error.message\n        );\n        await this.sleep(delay);\n      }\n    }\n\n    throw lastError;\n  }\n\n  /**\n   * Sleep utility\n   * @private\n   */\n  sleep(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n\n  /**\n   * Set global message timeout\n   * @param {number} timeout - Timeout in milliseconds\n   */\n  setTimeout(timeout) {\n    this.messageTimeout = timeout;\n  }\n\n  /**\n   * Set global retry configuration\n   * @param {number} attempts - Number of retry attempts\n   * @param {number} delay - Base delay in milliseconds\n   */\n  setRetryConfig(attempts, delay) {\n    this.retryAttempts = attempts;\n    this.retryDelay = delay;\n  }\n}\n\n/**\n * Comet messaging error class\n */\nclass CometMessagingError extends Error {\n  constructor(message, originalError) {\n    super(message);\n    this.name = 'CometMessagingError';\n    this.originalError = originalError;\n  }\n}\n\n// Create and export messaging instance\nexport const messaging = new CometMessagingManager();\n\n// Export class for advanced usage\nexport { CometMessagingManager, CometMessagingError };\n","/**\n * Comet Framework - Universal Script Bridge (Fixed - No Duplicate Handlers)\n * Simple and reliable - no CSP issues, easy to add modules\n * @module @voilajsx/comet\n * @file src/scripts/bridge.js\n */\n\n// ============================================================================\n// ðŸš€ ADD NEW MODULES HERE - Just add import and add to modules array below\n// ============================================================================\nimport pageAnalyzer from './modules/pageAnalyzer.js';\nimport quoteGenerator from './modules/quoteGenerator.js';\nimport userAuth from './modules/userAuth.js';\nimport tester from './modules/tester.js';\n// import newModule from './modules/newModule.js';           // <-- Add new imports here\n// import anotherModule from './modules/anotherModule.js';   // <-- Add new imports here\n\n// ============================================================================\n// ðŸš€ ADD NEW MODULES TO THIS ARRAY - Just add module name to array\n// ============================================================================\nconst ALL_MODULES = [\n  pageAnalyzer,\n  quoteGenerator,\n  userAuth,\n  tester,\n  // newModule,        // <-- Add new modules here\n  // anotherModule,    // <-- Add new modules here\n];\n\n// ============================================================================\n// ðŸ”’ FRAMEWORK CODE BELOW - NO NEED TO TOUCH ANYTHING BELOW THIS LINE\n// ============================================================================\n\n/**\n * Universal Comet Script Bridge\n * Registers modules statically - reliable and fast\n */\nclass CometScriptBridge {\n  constructor() {\n    this.isInitialized = false;\n    this.modules = new Map();\n    this.messageHandlers = new Map();\n    this.moduleRegistry = new Map();\n    this.moduleLoadStrategy = 'static-imports';\n    this.coreHandlers = new Set(); // âœ… ADD: Track core handlers\n\n    this.initialize();\n  }\n\n  async initialize() {\n    if (this.isInitialized) return;\n\n    console.log(\n      '[Comet Bridge] Universal bridge loading on:',\n      window.location.href\n    );\n\n    try {\n      this.setupMessageHandling();\n      this.registerCoreHandlers();\n      this.loadStaticModules();\n      this.notifyReady();\n      this.isInitialized = true;\n\n      console.log(\n        `[Comet Bridge] Initialized with ${this.modules.size} modules:`,\n        Array.from(this.modules.keys())\n      );\n    } catch (error) {\n      console.error('[Comet Bridge] Initialization error:', error);\n      this.isInitialized = true;\n    }\n  }\n\n  setupMessageHandling() {\n    try {\n      chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n        this.handleMessage(message, sender, sendResponse);\n        return true;\n      });\n    } catch (error) {\n      console.warn('[Comet Bridge] Message handling setup failed:', error);\n    }\n  }\n\n  registerCoreHandlers() {\n    // âœ… FIXED: Mark these as core handlers and register them properly\n    this.registerCoreHandler('ping', () => ({\n      success: true,\n      ready: true,\n      url: window.location.href,\n      timestamp: Date.now(),\n      modules: Array.from(this.modules.keys()),\n      moduleCount: this.modules.size,\n      loadStrategy: this.moduleLoadStrategy,\n    }));\n\n    this.registerCoreHandler('getPageInfo', () => ({\n      url: window.location.href,\n      title: document.title,\n      hostname: window.location.hostname,\n      timestamp: Date.now(),\n    }));\n\n    this.registerCoreHandler('getModules', () => ({\n      modules: Array.from(this.modules.keys()),\n      handlers: Array.from(this.messageHandlers.keys()),\n      moduleCount: this.modules.size,\n    }));\n\n    this.registerCoreHandler('performMainAction', (data) =>\n      this.performCombinedAction(data)\n    );\n  }\n\n  // âœ… NEW: Separate method for core handlers\n  registerCoreHandler(type, handler) {\n    if (typeof handler !== 'function') {\n      throw new Error(`Core handler for \"${type}\" must be a function`);\n    }\n\n    this.coreHandlers.add(type);\n    this.messageHandlers.set(type, handler);\n    this.moduleRegistry.set(type, 'core');\n\n    console.log(`[Comet Bridge] Core handler \"${type}\" registered`);\n  }\n\n  loadStaticModules() {\n    console.log('[Comet Bridge] Loading static modules...');\n\n    let loadedCount = 0;\n    for (const moduleData of ALL_MODULES) {\n      try {\n        if (moduleData) {\n          this.registerModule(moduleData);\n          loadedCount++;\n        }\n      } catch (error) {\n        console.warn('[Comet Bridge] Failed to register module:', error);\n      }\n    }\n\n    console.log(\n      `[Comet Bridge] Loaded ${loadedCount}/${ALL_MODULES.length} modules`\n    );\n  }\n\n  registerModule(moduleConfig) {\n    try {\n      if (!this.isValidModule(moduleConfig)) {\n        throw new Error('Invalid module configuration');\n      }\n\n      const name = moduleConfig.name;\n\n      if (this.modules.has(name)) {\n        console.warn(\n          `[Comet Bridge] Module \"${name}\" already registered, skipping`\n        );\n        return;\n      }\n\n      this.modules.set(name, moduleConfig);\n\n      if (moduleConfig.handlers) {\n        Object.entries(moduleConfig.handlers).forEach(\n          ([handlerName, handlerFunc]) => {\n            if (typeof handlerFunc === 'function') {\n              // âœ… FIXED: Check for conflicts with core handlers\n              if (this.coreHandlers.has(handlerName)) {\n                console.warn(\n                  `[Comet Bridge] Module \"${name}\" tried to register core handler \"${handlerName}\", skipping`\n                );\n                return;\n              }\n\n              // âœ… FIXED: Check for conflicts with other modules\n              if (this.messageHandlers.has(handlerName)) {\n                const existingModule = this.moduleRegistry.get(handlerName);\n                console.warn(\n                  `[Comet Bridge] Handler \"${handlerName}\" conflict: Module \"${name}\" vs existing \"${existingModule}\", skipping`\n                );\n                return;\n              }\n\n              this.registerHandler(handlerName, handlerFunc);\n              this.moduleRegistry.set(handlerName, name);\n            }\n          }\n        );\n      }\n\n      if (typeof moduleConfig.init === 'function') {\n        try {\n          moduleConfig.init();\n        } catch (error) {\n          console.warn(`[Comet Bridge] Module \"${name}\" init failed:`, error);\n        }\n      }\n\n      console.log(`[Comet Bridge] Module \"${name}\" registered successfully`);\n    } catch (error) {\n      console.error('[Comet Bridge] Module registration failed:', error);\n      throw error;\n    }\n  }\n\n  isValidModule(moduleConfig) {\n    return !!(\n      moduleConfig &&\n      typeof moduleConfig === 'object' &&\n      moduleConfig.name &&\n      typeof moduleConfig.name === 'string' &&\n      (moduleConfig.handlers || moduleConfig.mainAction)\n    );\n  }\n\n  // âœ… FIXED: Only register non-conflicting handlers\n  registerHandler(type, handler) {\n    if (typeof handler !== 'function') {\n      throw new Error(`Handler for \"${type}\" must be a function`);\n    }\n\n    // Don't log override warnings anymore since we prevent them above\n    this.messageHandlers.set(type, handler);\n  }\n\n  async handleMessage(message, sender, sendResponse) {\n    try {\n      const { type, data, id } = message;\n\n      if (!type) {\n        sendResponse({ success: false, error: 'Message type required' });\n        return;\n      }\n\n      console.log(`[Comet Bridge] Message: ${type}`, data);\n\n      const handler = this.messageHandlers.get(type);\n      if (!handler) {\n        sendResponse({\n          success: false,\n          error: `No handler for: ${type}`,\n          availableHandlers: Array.from(this.messageHandlers.keys()),\n          moduleCount: this.modules.size,\n          loadStrategy: this.moduleLoadStrategy,\n        });\n        return;\n      }\n\n      const result = await this.executeHandler(handler, data, sender);\n      const moduleOwner = this.moduleRegistry.get(type);\n\n      sendResponse({\n        success: true,\n        data: result,\n        module: moduleOwner,\n        id,\n      });\n    } catch (error) {\n      console.error('[Comet Bridge] Message handling error:', error);\n      sendResponse({\n        success: false,\n        error: error.message || 'Internal error',\n        id: message.id,\n      });\n    }\n  }\n\n  async executeHandler(handler, data, sender) {\n    try {\n      return await handler(data, sender);\n    } catch (error) {\n      console.error('[Comet Bridge] Handler execution error:', error);\n      throw error;\n    }\n  }\n\n  async performCombinedAction(data) {\n    const results = {};\n    const errors = {};\n\n    for (const [moduleName, moduleConfig] of this.modules) {\n      try {\n        if (\n          moduleConfig.mainAction &&\n          typeof moduleConfig.mainAction === 'function'\n        ) {\n          results[moduleName] = await moduleConfig.mainAction(data);\n        } else if (\n          moduleConfig.analyze &&\n          typeof moduleConfig.analyze === 'function'\n        ) {\n          results[moduleName] = await moduleConfig.analyze(data);\n        }\n      } catch (error) {\n        errors[moduleName] = error.message;\n        console.warn(`[Comet Bridge] Module \"${moduleName}\" failed:`, error);\n      }\n    }\n\n    return {\n      success: Object.keys(errors).length === 0,\n      message: `Combined action completed across ${\n        Object.keys(results).length\n      } modules`,\n      results,\n      errors: Object.keys(errors).length > 0 ? errors : undefined,\n      timestamp: Date.now(),\n      url: window.location.href,\n      loadStrategy: this.moduleLoadStrategy,\n    };\n  }\n\n  notifyReady() {\n    try {\n      chrome.runtime.sendMessage({\n        type: 'contentScriptReady',\n        data: {\n          url: window.location.href,\n          modules: Array.from(this.modules.keys()),\n          moduleCount: this.modules.size,\n          timestamp: Date.now(),\n          loadStrategy: this.moduleLoadStrategy,\n        },\n      });\n    } catch (error) {\n      console.warn('[Comet Bridge] Failed to notify background:', error);\n    }\n  }\n\n  // âœ… NEW: Debug method to show handler conflicts\n  getHandlerInfo() {\n    const info = {\n      totalHandlers: this.messageHandlers.size,\n      coreHandlers: Array.from(this.coreHandlers),\n      moduleHandlers: {},\n      allHandlers: Array.from(this.messageHandlers.keys()),\n    };\n\n    for (const [handler, module] of this.moduleRegistry) {\n      if (!info.moduleHandlers[module]) {\n        info.moduleHandlers[module] = [];\n      }\n      info.moduleHandlers[module].push(handler);\n    }\n\n    return info;\n  }\n}\n\n// Initialize the universal bridge\nconst scriptBridge = new CometScriptBridge();\n\n// Export for debugging\nif (typeof globalThis !== 'undefined') {\n  globalThis.scriptBridge = scriptBridge;\n\n  // âœ… NEW: Add debug helper\n  globalThis.debugHandlers = () => {\n    console.table(scriptBridge.getHandlerInfo());\n  };\n}\n","/**\n * Comet Framework - Complete Platform Tester Module (Fixed for Tabs API)\n * Tests all platform features for debugging and verification\n * @module @voilajsx/comet\n * @file src/scripts/modules/tester.js\n */\n\nimport { storage } from '@voilajsx/comet/storage';\nimport { messaging } from '@voilajsx/comet/messaging';\nimport { comet } from '@voilajsx/comet/api';\n\nexport default {\n  name: 'tester',\n\n  handlers: {\n    // ===== BADGE TESTS =====\n    testBadge: async () => {\n      await messaging.sendToBackground({\n        type: 'badge.setText',\n        data: { text: '5' },\n      });\n      return { success: true, message: 'Badge set to \"5\"' };\n    },\n\n    testBadgeColor: async () => {\n      await messaging.sendToBackground({\n        type: 'badge.setColor',\n        data: { color: '#FF0000' },\n      });\n      return { success: true, message: 'Badge color set to red' };\n    },\n\n    clearBadge: async () => {\n      await messaging.sendToBackground({\n        type: 'badge.setText',\n        data: { text: '' },\n      });\n      return { success: true, message: 'Badge cleared' };\n    },\n\n    // ===== TAB MANAGEMENT (FIXED) =====\n    openNewTab: async (data) => {\n      try {\n        const url = data?.url || 'https://google.com';\n        console.log('[Tester] Opening new tab:', url);\n\n        const response = await messaging.sendToBackground({\n          type: 'tabs.create',\n          data: { url, active: false }, // Don't steal focus\n        });\n\n        console.log('[Tester] Tab creation response:', response);\n\n        if (response.success && response.data?.tab) {\n          return {\n            success: true,\n            message: `Opened new tab: ${url}`,\n            tab: response.data.tab,\n          };\n        } else {\n          return {\n            success: false,\n            error: response.error || 'Tab creation failed',\n          };\n        }\n      } catch (error) {\n        console.error('[Tester] Tab creation error:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    getCurrentTab: async () => {\n      try {\n        console.log('[Tester] Getting current tab');\n\n        const response = await messaging.sendToBackground({\n          type: 'tabs.getCurrent',\n          data: {},\n        });\n\n        console.log('[Tester] Current tab response:', response);\n\n        if (response.success && response.data) {\n          const tab = response.data;\n          return {\n            success: true,\n            tab: {\n              id: tab.id,\n              title: tab.title,\n              url: tab.url,\n              active: tab.active,\n              windowId: tab.windowId,\n            },\n          };\n        } else {\n          return {\n            success: false,\n            error: response.error || 'No current tab found',\n          };\n        }\n      } catch (error) {\n        console.error('[Tester] Get current tab error:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    getAllTabs: async () => {\n      try {\n        console.log('[Tester] Getting all tabs');\n\n        const response = await messaging.sendToBackground({\n          type: 'tabs.query',\n          data: {},\n        });\n\n        console.log('[Tester] All tabs response:', response);\n\n        if (response.success && Array.isArray(response.data)) {\n          const tabs = response.data;\n          return {\n            success: true,\n            tabCount: tabs.length,\n            tabs: tabs.map((tab) => ({\n              id: tab.id,\n              title: tab.title || 'No title',\n              url: tab.url || 'No URL',\n              active: tab.active,\n              windowId: tab.windowId,\n            })),\n          };\n        } else {\n          return {\n            success: false,\n            error: response.error || 'Failed to get tabs',\n          };\n        }\n      } catch (error) {\n        console.error('[Tester] Get all tabs error:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    // ===== ADVANCED TAB OPERATIONS =====\n    closeTab: async (data) => {\n      try {\n        const tabId = data?.tabId;\n        if (!tabId) {\n          return { success: false, error: 'Tab ID required' };\n        }\n\n        const response = await messaging.sendToBackground({\n          type: 'tabs.remove',\n          data: { tabId },\n        });\n\n        if (response.success) {\n          return {\n            success: true,\n            message: `Closed tab ${tabId}`,\n          };\n        } else {\n          return {\n            success: false,\n            error: response.error || 'Tab close failed',\n          };\n        }\n      } catch (error) {\n        console.error('[Tester] Close tab error:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    duplicateCurrentTab: async () => {\n      try {\n        // First get current tab\n        const currentResponse = await messaging.sendToBackground({\n          type: 'tabs.getCurrent',\n          data: {},\n        });\n\n        if (!currentResponse.success || !currentResponse.data) {\n          return { success: false, error: 'Could not get current tab' };\n        }\n\n        const currentTab = currentResponse.data;\n\n        // Duplicate it\n        const response = await messaging.sendToBackground({\n          type: 'tabs.duplicate',\n          data: { tabId: currentTab.id },\n        });\n\n        if (response.success && response.data?.tab) {\n          return {\n            success: true,\n            message: 'Current tab duplicated',\n            duplicatedTab: response.data.tab,\n          };\n        } else {\n          return {\n            success: false,\n            error: response.error || 'Tab duplication failed',\n          };\n        }\n      } catch (error) {\n        console.error('[Tester] Duplicate tab error:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    reloadCurrentTab: async (data) => {\n      try {\n        // Get current tab first\n        const currentResponse = await messaging.sendToBackground({\n          type: 'tabs.getCurrent',\n          data: {},\n        });\n\n        if (!currentResponse.success || !currentResponse.data) {\n          return { success: false, error: 'Could not get current tab' };\n        }\n\n        const currentTab = currentResponse.data;\n\n        // Reload it\n        const response = await messaging.sendToBackground({\n          type: 'tabs.reload',\n          data: {\n            tabId: currentTab.id,\n            bypassCache: data?.bypassCache || false,\n          },\n        });\n\n        if (response.success) {\n          return {\n            success: true,\n            message: `Reloaded current tab${\n              data?.bypassCache ? ' (bypassed cache)' : ''\n            }`,\n          };\n        } else {\n          return {\n            success: false,\n            error: response.error || 'Tab reload failed',\n          };\n        }\n      } catch (error) {\n        console.error('[Tester] Reload tab error:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    // ===== STORAGE TESTS =====\n    testStorage: async (data) => {\n      const key = data?.key || 'test.demo';\n      const value = data?.value || `Test at ${new Date().toLocaleTimeString()}`;\n\n      await storage.set(key, value);\n      const retrieved = await storage.get(key);\n\n      return {\n        success: true,\n        stored: { key, value },\n        retrieved,\n      };\n    },\n\n    getStorageUsage: async () => {\n      const usage = await storage.getUsage();\n      return { success: true, usage };\n    },\n\n    clearTestStorage: async () => {\n      await storage.remove(['test.demo', 'test.key', 'test.comprehensive']);\n      return { success: true, message: 'Test storage cleared' };\n    },\n\n    // ===== API TESTS =====\n    testApiGet: async () => {\n      try {\n        const response = await comet.get(\n          'https://jsonplaceholder.typicode.com/posts/1'\n        );\n        return {\n          success: true,\n          message: 'API GET successful',\n          data: {\n            id: response.data.id,\n            title: response.data.title,\n            body: response.data.body.slice(0, 50) + '...',\n          },\n        };\n      } catch (error) {\n        return { success: false, error: 'API GET failed: ' + error.message };\n      }\n    },\n\n    testApiPost: async () => {\n      try {\n        const response = await comet.post(\n          'https://jsonplaceholder.typicode.com/posts',\n          {\n            title: 'Test Post from Comet',\n            body: 'This is a test post',\n            userId: 1,\n          }\n        );\n        return {\n          success: true,\n          message: 'API POST successful',\n          data: {\n            id: response.data.id,\n            title: response.data.title,\n          },\n        };\n      } catch (error) {\n        return { success: false, error: 'API POST failed: ' + error.message };\n      }\n    },\n\n    // ===== PAGE INTERACTION =====\n    getDetailedPageInfo: async () => {\n      return {\n        success: true,\n        pageInfo: {\n          title: document.title,\n          url: window.location.href,\n          domain: window.location.hostname,\n          wordCount: document.body.innerText.split(' ').length,\n          linkCount: document.links.length,\n          imageCount: document.images.length,\n          lastModified: document.lastModified,\n          characterCount: document.body.innerText.length,\n          scriptCount: document.scripts.length,\n          stylesheetCount: document.styleSheets.length,\n          metaTags: Array.from(document.querySelectorAll('meta')).length,\n          headings: {\n            h1: document.querySelectorAll('h1').length,\n            h2: document.querySelectorAll('h2').length,\n            h3: document.querySelectorAll('h3').length,\n          },\n        },\n      };\n    },\n\n    findElement: async (data) => {\n      const selector = data?.selector || 'h1';\n      const element = document.querySelector(selector);\n\n      if (element) {\n        return {\n          success: true,\n          found: true,\n          element: {\n            tagName: element.tagName,\n            textContent: element.textContent.slice(0, 100),\n            id: element.id || 'no-id',\n            className: element.className || 'no-class',\n          },\n        };\n      } else {\n        return {\n          success: true,\n          found: false,\n          message: `Element \"${selector}\" not found`,\n        };\n      }\n    },\n\n    highlightElements: async (data) => {\n      const selector = data?.selector || 'h1, h2, h3';\n      const elements = document.querySelectorAll(selector);\n\n      elements.forEach((el) => {\n        el.style.backgroundColor = 'yellow';\n        el.style.border = '2px solid red';\n      });\n\n      return {\n        success: true,\n        highlighted: elements.length,\n        selector,\n      };\n    },\n\n    removeHighlight: async () => {\n      const elements = document.querySelectorAll(\n        '*[style*=\"background-color: yellow\"]'\n      );\n      elements.forEach((el) => {\n        el.style.backgroundColor = '';\n        el.style.border = '';\n      });\n\n      return {\n        success: true,\n        removed: elements.length,\n        message: 'Highlights removed',\n      };\n    },\n\n    // ===== MESSAGING TESTS =====\n    testEcho: async (data) => {\n      return {\n        success: true,\n        echo: data,\n        timestamp: Date.now(),\n        message: 'Echo test successful',\n      };\n    },\n\n    testBroadcast: async () => {\n      const results = await messaging.broadcast({\n        type: 'testMessage',\n        data: {\n          from: 'tester',\n          message: 'Broadcast test',\n          timestamp: Date.now(),\n        },\n      });\n\n      const successful = results.filter((r) => r.success).length;\n\n      return {\n        success: true,\n        message: `Broadcast sent to ${results.length} tabs`,\n        successful,\n        total: results.length,\n      };\n    },\n\n    // ===== DOWNLOADS TEST =====\n    testDownload: async () => {\n      const testData = {\n        extensionName: 'Comet Tester',\n        timestamp: new Date().toISOString(),\n        testResults: {\n          badge: 'working',\n          storage: 'working',\n          messaging: 'working',\n        },\n      };\n\n      await messaging.sendToBackground({\n        type: 'downloads.downloadData',\n        data: {\n          data: JSON.stringify(testData, null, 2),\n          filename: 'comet-test-export.json',\n          mimeType: 'application/json',\n        },\n      });\n\n      return {\n        success: true,\n        message: 'Test data downloaded as JSON file',\n      };\n    },\n\n    // ===== BOOKMARKS TEST =====\n    bookmarkCurrentPage: async () => {\n      await messaging.sendToBackground({\n        type: 'bookmarks.create',\n        data: {\n          title: `Test Bookmark - ${document.title}`,\n          url: window.location.href,\n        },\n      });\n\n      return {\n        success: true,\n        message: 'Current page bookmarked',\n        page: document.title,\n      };\n    },\n\n    // ===== CONTEXT MENU TEST =====\n    createContextMenu: async () => {\n      await messaging.sendToBackground({\n        type: 'contextMenu.create',\n        data: {\n          id: 'comet-test',\n          title: 'Test Comet Extension',\n          contexts: ['page', 'selection'],\n        },\n      });\n\n      return {\n        success: true,\n        message: 'Context menu created (right-click page to see)',\n      };\n    },\n\n    removeContextMenu: async () => {\n      await messaging.sendToBackground({\n        type: 'contextMenu.remove',\n        data: { id: 'comet-test' },\n      });\n\n      return {\n        success: true,\n        message: 'Context menu removed',\n      };\n    },\n\n    // ===== COMPREHENSIVE TEST =====\n    runAllTests: async () => {\n      const results = {};\n\n      try {\n        // Test storage\n        await storage.set('test.comprehensive', 'test-value');\n        const stored = await storage.get('test.comprehensive');\n        results.storage = stored === 'test-value' ? 'PASS' : 'FAIL';\n\n        // Test API\n        const apiResponse = await comet.get(\n          'https://jsonplaceholder.typicode.com/posts/1'\n        );\n        results.api = apiResponse.ok ? 'PASS' : 'FAIL';\n\n        // Test page access\n        results.pageAccess = document.title ? 'PASS' : 'FAIL';\n\n        // Test badge\n        await messaging.sendToBackground({\n          type: 'badge.setText',\n          data: { text: 'âœ“' },\n        });\n        results.badge = 'PASS';\n\n        // Test tab query\n        const tabResponse = await messaging.sendToBackground({\n          type: 'tabs.query',\n          data: { active: true },\n        });\n        results.tabManagement = tabResponse.success ? 'PASS' : 'FAIL';\n\n        // Test tab creation\n        const createResponse = await messaging.sendToBackground({\n          type: 'tabs.create',\n          data: { url: 'https://example.com', active: false },\n        });\n        results.tabCreation = createResponse.success ? 'PASS' : 'FAIL';\n\n        // Close the test tab if created\n        if (createResponse.success && createResponse.data?.tab?.id) {\n          setTimeout(async () => {\n            try {\n              await messaging.sendToBackground({\n                type: 'tabs.remove',\n                data: { tabId: createResponse.data.tab.id },\n              });\n            } catch (e) {\n              console.warn('Failed to close test tab:', e);\n            }\n          }, 2000);\n        }\n\n        // Test core messaging\n        const pingResponse = await messaging.sendToBackground({\n          type: 'ping',\n        });\n        results.coreMessaging = pingResponse.success ? 'PASS' : 'FAIL';\n      } catch (error) {\n        results.error = error.message;\n      }\n\n      return {\n        success: true,\n        testResults: results,\n        summary: `${\n          Object.values(results).filter((r) => r === 'PASS').length\n        } tests passed`,\n      };\n    },\n\n    // ===== DEBUG HELPERS =====\n    debugHandlers: async () => {\n      // Use the global debug function if available\n      if (typeof globalThis !== 'undefined' && globalThis.debugHandlers) {\n        globalThis.debugHandlers();\n      }\n\n      return {\n        success: true,\n        message: 'Check console for handler information',\n        availableHandlers: Array.from(\n          globalThis.scriptBridge?.messageHandlers?.keys() || []\n        ),\n      };\n    },\n\n    // ===== PERMISSIONS TEST =====\n    checkPermissions: async () => {\n      try {\n        const hasTabsPermission = await new Promise((resolve) => {\n          chrome.permissions.contains({ permissions: ['tabs'] }, resolve);\n        });\n\n        const hasHostPermission = await new Promise((resolve) => {\n          chrome.permissions.contains({ origins: ['<all_urls>'] }, resolve);\n        });\n\n        const hasBookmarksPermission = await new Promise((resolve) => {\n          chrome.permissions.contains({ permissions: ['bookmarks'] }, resolve);\n        });\n\n        const hasDownloadsPermission = await new Promise((resolve) => {\n          chrome.permissions.contains({ permissions: ['downloads'] }, resolve);\n        });\n\n        return {\n          success: true,\n          permissions: {\n            tabs: hasTabsPermission,\n            hostPermissions: hasHostPermission,\n            bookmarks: hasBookmarksPermission,\n            downloads: hasDownloadsPermission,\n          },\n          message: `Permissions check complete`,\n        };\n      } catch (error) {\n        return {\n          success: false,\n          error: 'Permission check failed: ' + error.message,\n        };\n      }\n    },\n\n    // ===== WINDOW OPERATIONS =====\n    getCurrentWindow: async () => {\n      try {\n        const response = await messaging.sendToBackground({\n          type: 'windows.getCurrent',\n          data: {},\n        });\n\n        if (response.success) {\n          return {\n            success: true,\n            window: response.data,\n          };\n        } else {\n          return {\n            success: false,\n            error: response.error || 'Failed to get current window',\n          };\n        }\n      } catch (error) {\n        return { success: false, error: error.message };\n      }\n    },\n\n    // ===== EXTENSION INFO =====\n    getExtensionInfo: async () => {\n      try {\n        const response = await messaging.sendToBackground({\n          type: 'extension.getInfo',\n          data: {},\n        });\n\n        if (response.success) {\n          return {\n            success: true,\n            extensionInfo: response.data,\n          };\n        } else {\n          return {\n            success: false,\n            error: response.error || 'Failed to get extension info',\n          };\n        }\n      } catch (error) {\n        return { success: false, error: error.message };\n      }\n    },\n  },\n\n  init: () => {\n    console.log(\n      '[Tester] Complete platform tester initialized (tabs API fixed)'\n    );\n  },\n};\n"],"names":["getPageData","word","getPageSize","html","text","formatBytes","bytes","k","sizes","i","pageAnalyzerModule","comet","url","options","response","resolve","reject","error","headers","data","quoteGeneratorModule","getRandomQuote","getMotivationalQuote","apis","api","quote","getFallbackQuote","result","getMotivationalFallback","quotes","browserAPI","CometStorageManager","defaultsModule","__vitePreload","defaults$1","obj","prefix","key","value","fullKey","keys","fallback","namespace","defaultValue","CometStorageError","results","val","storageArea","usage","syncUsed","localUsed","callback","listener","changes","items","path","storageData","lastKey","target","o","operation","dataSize","itemSize","message","originalError","storage","userAuthModule","loginUser","logoutUser","getUserProfile","checkAuthStatus","email","password","storeAuthToken","token","getStoredAuthToken","cachedUserData","getCachedUserData","user","userData","cacheUserData","sessionDays","timestamp","tokenAge","maxAge","cacheTime","cacheAge","maxCacheAge","CometMessagingManager","messageWithId","timeout","retries","CometMessagingError","tabId","targetTabId","tabs","responses","tab","sender","sendResponse","type","activeTab","timeoutId","maxRetries","lastError","attempt","delay","ms","attempts","messaging","ALL_MODULES","pageAnalyzer","quoteGenerator","userAuth","currentResponse","currentTab","retrieved","selector","element","elements","el","successful","r","testData","stored","apiResponse","tabResponse","createResponse","e","pingResponse","hasTabsPermission","hasHostPermission","hasBookmarksPermission","hasDownloadsPermission","CometScriptBridge","handler","loadedCount","moduleData","moduleConfig","name","handlerName","handlerFunc","existingModule","id","moduleOwner","errors","moduleName","info","module","scriptBridge"],"mappings":"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"}